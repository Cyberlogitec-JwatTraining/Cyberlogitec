<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
				"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="vn.com.cyberlogitec.mapper.StudentMapper">
    <insert id="insertStudent" parameterType="Student" >
        INSERT INTO STUDENT (NAME, BRANCH, PERCENTAGE, PHONE, EMAIL ) VALUES (#{name}, #{branch}, #{percentage}, #{phone}, #{email});
    </insert>
     
    <select id="selectAllStudent" resultMap="result">
        SELECT * FROM STUDENT;
    </select>
     
    <select id="selectStudentById" parameterType="int" resultType="Student">
        SELECT * FROM STUDENT WHERE ID = #{id};
    </select>
    
    <!-- Câu 1 -->
    <select id="selectStudentByName" parameterType="java.lang.String" resultMap="result">
    	SELECT * FROM STUDENT 
    	<if test="name != null">
    		WHERE name LIKE CONCAT('%',#{studentName},'%');
    	</if>
    </select>
    
    <!-- Câu 2 -->
    <select id="selectStudentByOption" parameterType="Student" resultMap="result">
    	SELECT * FROM STUDENT WHERE 1 = 1 
    	<choose>
    		<when test="name != null">
    			AND name LIKE CONCAT('%',#{name},'%');
    		</when>
    		<when test="phone != null">
    			AND phone LIKE CONCAT('%',#{phone},'%');
    		</when>
    	</choose>
    </select>
    
    <!-- Câu 3 -->
    <select id="selectMultipleStudentByIds" resultMap="result">
    	SELECT * 
    	FROM STUDENT
    	WHERE id in
    	<foreach item="id" index="index" collection="array" open="(" separator="," close=")">
    		#{id}
    	</foreach>
    </select>
    
    <!-- Câu 4 -->
    
    <!-- Câu 5 -->
    <update id="updateStudentById">
	  UPDATE Student 
	    <set>
	      <if test="name != null">name=#{name},</if>
	      <if test="branch != null">branch=#{branch},</if>
	      <if test="percentage != null">percentage=#{percentage},</if>
	      <if test="phone != null">phone=#{phone},</if>
	      <if test="email != null">email=#{email} </if>
	    </set>
	  WHERE id=#{id}
	</update>
     
    <resultMap id = "result" type = "Student">
       <result property = "id" column = "ID"/>
       <result property = "name" column = "NAME"/>
       <result property = "branch" column = "BRANCH"/>
       <result property = "percentage" column = "PERCENTAGE"/>
       <result property = "phone" column = "PHONE"/>
       <result property = "email" column = "EMAIL"/>
    </resultMap>
</mapper>